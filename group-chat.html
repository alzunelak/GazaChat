<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WhatsApp Group Info</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<style>


/* ===== GENERAL ===== */
body {
  margin: 0;
  font-family: 'Segoe UI', Arial, sans-serif;
  background: #f0f0f0;
  color: #000;
  height: 100vh;
  display: flex;
  justify-content: center; /* center app on larger screens */
  align-items: flex-start;
  padding: 20px 0;
}

/* ===== APP CONTAINERS ===== */
#chatPage, #groupInfoPage {
  width: 100%;
  max-width: 900px; /* wider on laptops */
  background: #fff;
  border-radius: 10px;
  border: 1px solid #ccc;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}

/* ===== HEADER ===== */
.header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: #075E54;
  color: white;
  padding: 10px 15px;
}
.header img {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  cursor: pointer;
  object-fit: cover;
}
.header-info {
  flex: 1;
  display: flex;
  flex-direction: column;
  margin-left: 10px;
  overflow: hidden;
}
.header-info h2 {
  margin: 0;
  font-size: 16px;
  cursor: pointer;
}
.header-info #members {
  font-size: 12px;
  color: #d0f0e3;
}

/* ===== CHAT BOX ===== */
#chatBox {
  flex: 1;
  overflow-y: auto;
  padding: 10px 15px;
  margin-bottom: 100px;
}
#chatBox::-webkit-scrollbar {
  width: 8px;
}
#chatBox::-webkit-scrollbar-thumb {
  background: rgba(0,0,0,0.2);
  border-radius: 4px;
}

/* ===== MESSAGES ===== */
.msg {
  max-width: 80%;
  padding: 12px 16px;
  margin: 5px 0;
  border-radius: 18px;
  background: #f1f1f1;
  word-break: break-word;
  font-size: 14px;
  position: relative;
}
.msg.self {
  background: #dcf8c6;
  align-self: flex-end;
}
.msg .meta {
  font-size: 10px;
  color: #999;
  text-align: right;
}
.msg img {
  max-width: 200px;
  border-radius: 8px;
}
.msg audio {
  width: 100%;
  max-width: 500px;
  border-radius: 8px;
  outline: none;
}

/* ===== INPUT AREA ===== */
#inputArea {
  display: flex;
  align-items: center;
  position: fixed;
  bottom: 10px;
  left: 50%;
  transform: translateX(-50%);
  width: calc(100% - 40px);
  z-index: 100;
  gap: 6px;
}
.input-box {
  display: flex;
  flex: 1;
  background: #f1f1f1;
  border-radius: 25px;
  padding: 6px 10px;
  gap: 6px;
}
.input-box input {
  flex: 1;
  border: none;
  outline: none;
  font-size: 14px;
  background: transparent;
}
.input-buttons button {
  background: transparent;
  border: none;
  font-size: 20px;
  cursor: pointer;
  color: #128C7E;
}
#micBtn {
  width: 45px;
  height: 45px;
  border-radius: 50%;
  background: #25D366;
  color: white;
  border: none;
  font-size: 18px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* ===== ATTACHMENT MENU ===== */
#attachmentMenu {
  display: none;
  position: fixed;
  bottom: 60px;
  left: 50%;
  transform: translateX(-50%);
  background: #fff;
  padding: 10px;
  border-radius: 10px;
  z-index: 101;
}
#attachmentMenu .grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
  gap: 10px;
}
#attachmentMenu button {
  padding: 10px;
  border: none;
  border-radius: 8px;
  background: #128C7E;
  color: white;
  cursor: pointer;
  font-size: 16px;
}

/* ===== EMOJI PICKER ===== */
#emojiPicker {
  display: none;
  position: absolute;
  bottom: 60px;
  right: 10px;
  background: #fff;
  border-radius: 10px;
  padding: 5px;
  max-width: 300px;
  max-height: 150px;
  overflow-y: auto;
  flex-wrap: wrap;
  gap: 5px;
}

/* ===== GROUP INFO PAGE ===== */
#groupInfoPage {
  display: none;
  flex: 1;
  overflow-y: auto;
  background: #fff;
  padding-bottom: 20px;
}
.groupHeader {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 15px;
  background: #fff;
  color: #000;
  margin-bottom: 10px;
  border-radius: 10px;
  position: relative;
}
.groupHeader img {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  cursor: pointer;
  margin-bottom: 10px;
  object-fit: cover;
}
.groupHeader h2 {
  margin: 0;
  font-size: 18px;
  font-weight: 500;
  cursor: text;
}

/* ===== RESPONSIVE ===== */
@media (min-width: 768px) {
  .msg {
    font-size: 16px;
    padding: 14px 18px;
    max-width: 70%;
  }
  #chatBox {
    padding: 15px 20px;
  }
  #inputArea {
    width: calc(100% - 60px);
  }
  #attachmentMenu .grid {
    grid-template-columns: repeat(6, 1fr);
  }
}

  
</style>
</head>
<body>

<!-- CHAT PAGE -->
<div id="chatPage">
  <div class="header">
    <img id="groupPhoto" src="profile.png">
    <div class="header-info">
      <h2 id="groupName">My Group</h2>
      <div id="members"></div>
    </div>
    <div class="header-actions">
      <button id="callBtn"><i class="fa-solid fa-phone"></i></button>
      <button id="menuBtn"><i class="fa-solid fa-ellipsis-vertical"></i></button>
    </div>
  </div>
  <div id="chatBox"></div>
  <div id="inputArea">
    <div class="input-box">
      <input id="msgInput" placeholder="Type a message...">
      <div class="input-buttons">
        <button id="emojiBtn"><i class="fa-solid fa-face-smile"></i></button>
        <button id="plusBtn"><i class="fa-solid fa-paperclip"></i></button>
      </div>
    </div>
    <button id="micBtn"><i class="fa-solid fa-microphone"></i></button>
  </div>

  <div id="attachmentMenu">
    <div class="grid">
      <input type="file" id="fileInput" style="display:none">
      <input type="file" id="galleryInput" accept="image/*" style="display:none">
      <button id="sendDocumentBtn"><i class="fa-solid fa-paperclip"></i>File</button>
      <button id="galleryBtn"><i class="fa-solid fa-image"></i>Photo</button>
      <button id="cameraBtn"><i class="fa-solid fa-camera"></i>Camera</button>
      <button id="sendLocationBtn"><i class="fa-solid fa-location-dot"></i>Location</button>
      <!-- Audio Button -->
<button id="audioBtn"><i class="fa-solid fa-music"></i>Audio</button>
<!-- Hidden file input -->
<input type="file" id="audioInput" accept="audio/*" style="display:none;">
<button id="pollBtn"><i class="fa-solid fa-chart-simple"></i>Poll</button>

      <button id="contactBtn"><i class="fa-solid fa-user"></i>Contact</button>
      <button id="distanceBtn"><i class="fa-solid fa-location-crosshairs"></i>Distance</button>
    </div>
  </div>

  <div id="emojiPicker"></div>
</div>

<!-- GROUP INFO PAGE -->
<div id="groupInfoPage">
  <div class="groupHeader">
    <i class="fa-solid fa-arrow-left backArrow" onclick="backToChat()"></i>
    <img id="infoGroupPhoto" src="profile.png">
    <h2 id="infoGroupName" contenteditable="true">My Group</h2>
    <div class="actionButtons">
      <button><i class="fa-solid fa-video"></i><span>Video Call</span></button>
      <button><i class="fa-solid fa-phone"></i><span>Audio Call</span></button>
      <button><i class="fa-solid fa-magnifying-glass"></i><span>Search</span></button>
    </div>
  </div>

  <div class="settingsContainer">
    <button><i class="fa-solid fa-lock"></i>End-to-end Encryption</button>
    <button><i class="fa-solid fa-network-wired"></i>MESH NETWORK FORM</button>
    <button><i class="fa-solid fa-paint-roller"></i>Chat Color & Wallpaper</button>
    <button><i class="fa-solid fa-shield"></i>Advanced Chat Privacy<input type="checkbox"></button>
  </div>

  <div class="container">
    <div class="membersHeader">
      <span id="memberCount">0 Members</span>
      <button id="addMemberBtn">+</button>
    </div>
    <div id="groupMembersList"></div>
  </div>

  <div class="container" id="groupLinks">
    <button id="showGroupLink">Group Link</button>
    <button id="requestInviteBtn">Request / Invite</button>
  </div>

  <div id="linkPopup" style="display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%);
     background:#fff; padding:20px; border-radius:10px; box-shadow:0 2px 10px rgba(0,0,0,0.3); z-index:100;">
    <p>Your Group Link:</p>
    <input type="text" value="https://example.com/join/group123" id="groupLinkInput" readonly style="width:100%; padding:5px;"/>
    <button onclick="copyLink()" style="margin-top:10px;">Copy Link</button>
    <button onclick="closePopup()" style="margin-top:10px;">Close</button>
  </div>

  <div class="container actionBox">
    <button onclick="leaveGroup()"><i class="fa-solid fa-sign-out"></i><span>Leave Group</span></button>
    <button onclick="blockGroup()"><i class="fa-solid fa-ban"></i><span>Block Group</span></button>
    <button onclick="reportGroup()"><i class="fa-solid fa-flag"></i><span>Report Group</span></button>
    <button onclick="deleteGroup()"><i class="fa-solid fa-trash"></i><span>Delete Group</span></button>
    <button onclick="blockMember()"><i class="fa-solid fa-user-slash"></i><span>Block Member</span></button>
  </div>

  <input type="file" id="groupPhotoFile" accept="image/*" style="display:none;">
</div>

<script>
/* ===== DATA ===== */
let allFriends = JSON.parse(localStorage.getItem("friendsList") || '["Alice","Bob","Charlie"]'); 
let currentGroupMembers = JSON.parse(localStorage.getItem("groupMembers") || []);
let messages = [];
let currentGroup = "My Group";
let groupData = { "My Group": { photo: "profile.png", members: [...currentGroupMembers], admin: true } };

/* ===== RENDER FUNCTIONS ===== */
function renderChatMembers(){
  document.getElementById("members").textContent = currentGroupMembers.join(", ");
}
function renderGroupMembers(){
  const membersDiv = document.getElementById("groupMembersList");
  membersDiv.innerHTML = "";
  if(currentGroupMembers.length === 0){
    const div = document.createElement("div");
    div.textContent = "No members yet";
    div.style.fontStyle = "italic";
    div.style.color = "#555";
    membersDiv.appendChild(div);
  } else {
    currentGroupMembers.forEach(name=>{
      const div = document.createElement("div");
      div.textContent = name;
      div.className = "memberBox";
      membersDiv.appendChild(div);
    });
  }
  document.getElementById("memberCount").textContent = `${currentGroupMembers.length} Member${currentGroupMembers.length !== 1 ? 's' : ''}`;
  localStorage.setItem("groupMembers", JSON.stringify(currentGroupMembers));
  renderChatMembers();
}

/* ===== ADD MEMBER ===== */
document.getElementById("addMemberBtn").onclick = () => {
  const friendsToAdd = allFriends.filter(f => !currentGroupMembers.includes(f));
  if(friendsToAdd.length === 0){ alert("No friends to add yet."); return; }
  const friend = prompt("Add member:\n" + friendsToAdd.join("\n"));
  if(friend && friendsToAdd.includes(friend)){
    currentGroupMembers.push(friend);
    renderGroupMembers();
  }
};

/* ===== CHAT ===== */
const chatBox=document.getElementById("chatBox");
const msgInput=document.getElementById("msgInput");
function uid(){ return Date.now().toString(36)+'-'+Math.random().toString(36).slice(2,8); }
msgInput.addEventListener("keydown",e=>{
  if(e.key==="Enter"){ e.preventDefault(); const txt=msgInput.value.trim();
    if(!txt) return; messages.push({id:uid(), text:txt, self:true, time:new Date().toLocaleTimeString()});
    msgInput.value=""; renderMessages();
  }
});
function renderMessages(){
  chatBox.innerHTML="";
  messages.forEach(m=>{
    const div=document.createElement("div");
    div.className="msg"+(m.self?" self":"");
    div.innerHTML=`<div class="content">${m.text}</div><div class="meta">${m.time}</div>`;
    chatBox.appendChild(div);
  });
  chatBox.scrollTop = chatBox.scrollHeight;
}

/* ===== ADD MESSAGE HELPER ===== */
function addMessage(content,type="sent"){
  const msg = document.createElement("div");
  msg.classList.add("msg", type==="sent"?"self":"");
  msg.innerHTML = `<div class="content">${content}</div><div class="meta">${new Date().toLocaleTimeString()}</div>`;
  chatBox.appendChild(msg);
  chatBox.scrollTop = chatBox.scrollHeight;
}

/* ===== ATTACHMENT MENU ===== */
document.getElementById("plusBtn").onclick = () => {
  const menu = document.getElementById("attachmentMenu");
  menu.style.display = menu.style.display === "block" ? "none" : "block";
};
document.getElementById("sendDocumentBtn").onclick = ()=>{ document.getElementById("fileInput").click(); };
document.getElementById("fileInput").onchange = e=>{
  const file = e.target.files[0]; if(file) addMessage(`ðŸ“Ž File: ${file.name}`);
};
document.getElementById("galleryBtn").onclick = ()=>{ document.getElementById("galleryInput").click(); };
document.getElementById("galleryInput").onchange = e=>{
  const file = e.target.files[0];
  if(file){ const imgURL = URL.createObjectURL(file); addMessage(`<img src="${imgURL}" style="max-width:150px; border-radius:8px;">`); }
};
document.getElementById("cameraBtn").onclick = ()=> addMessage("ðŸ“· [Camera opened]");
document.getElementById("sendLocationBtn").onclick = ()=>{
  if(navigator.geolocation){ navigator.geolocation.getCurrentPosition(pos=>{
    const {latitude, longitude}=pos.coords; addMessage(`ðŸ“ Location: ${latitude}, ${longitude}`);
  }); }
};
  
// Audio button opens file picker
document.getElementById("audioBtn").onclick = () => {
  const input = document.getElementById("audioInput");

  // For mobile, suggest using "Files" instead of recorder
  if (/Android|iPhone|iPad/i.test(navigator.userAgent)) {
    alert("Please choose 'Files' to select an existing audio instead of recording.");
  }

  input.click();
};

// When a file is selected
document.getElementById("audioInput").onchange = (e) => {
  const file = e.target.files[0];
  if(file){
    const audioURL = URL.createObjectURL(file);
    addMessage(`<audio controls src="${audioURL}"></audio>`);
  }
};


  document.getElementById("pollBtn").onclick = () => {
  const question = prompt("Enter your poll question:");
  if(!question) return;

  const options = prompt("Enter options separated by commas (e.g. Yes,No,Maybe):");
  if(!options) return;

  const optionList = options.split(",").map(o => o.trim()).filter(o => o);
  if(optionList.length === 0) return;

  // Create poll message
  let pollHTML = `<div class="poll"><strong>${question}</strong><ul>`;
  optionList.forEach(o => {
    pollHTML += `<li>${o} <button onclick="vote(this)">Vote</button> <span class="votes">0</span></li>`;
  });
  pollHTML += `</ul></div>`;

  addMessage(pollHTML);

  // Scroll chat to bottom
  chatBox.scrollTop = chatBox.scrollHeight;
};

// Voting function
function vote(btn){
  const votesSpan = btn.nextElementSibling;
  votesSpan.textContent = parseInt(votesSpan.textContent)+1;
}

  
document.getElementById("contactBtn").onclick = ()=> addMessage("ðŸ‘¤ [Contact shared]");
document.getElementById("distanceBtn").onclick = ()=> addMessage("ðŸ“ [Distance info]");


/* ===== EMOJI PICKER ===== */
const emojiBtn = document.getElementById("emojiBtn");
const emojiPicker = document.getElementById("emojiPicker");
const emojis = ["ðŸ˜€","ðŸ˜ƒ","ðŸ˜„","ðŸ˜","ðŸ˜†","ðŸ˜…","ðŸ˜‚","ðŸ¤£","ðŸ˜Š","ðŸ˜‡","ðŸ™‚","ðŸ™ƒ","ðŸ˜‰","ðŸ˜","ðŸ¥°","ðŸ˜˜","ðŸ˜—","ðŸ˜™","ðŸ˜š"];

// Render emojis inside picker
function renderEmojis() {
  emojiPicker.innerHTML = "";
  emojis.forEach(e => {
    const span = document.createElement("span");
    span.textContent = e;
    span.style.cursor = "pointer";
    span.style.fontSize = "20px";
    span.addEventListener("click", () => {
      msgInput.value += e;                 // Add emoji to input
      msgInput.focus();                     // Focus input
      emojiPicker.style.display = "none";  // Close picker after selection
    });
    emojiPicker.appendChild(span);
  });
}

// Only render once
renderEmojis();

// Ensure emojiPicker is hidden initially
emojiPicker.style.display = "none";

// Toggle emoji picker on button click
emojiBtn.addEventListener("click", (e) => {
  e.stopPropagation();  // Prevent document click from closing immediately
  emojiPicker.style.display = emojiPicker.style.display === "flex" ? "none" : "flex";
});

// Close picker when clicking outside
document.addEventListener("click", (e) => {
  if (!emojiPicker.contains(e.target) && e.target !== emojiBtn) {
    emojiPicker.style.display = "none";
  }
});


/* ===== MIC BUTTON ===== */
const micBtn = document.getElementById("micBtn");
micBtn.onclick = ()=>{ const txt = prompt("Simulate voice input (type your message):"); if(txt && txt.trim()!==""){ messages.push({id:Date.now(), text:txt, self:true, time:new Date().toLocaleTimeString()}); renderMessages(); } };

/* ===== GROUP INFO ===== */
document.getElementById("groupName").onclick = ()=> openGroupInfo(currentGroup);
function openGroupInfo(groupName){
  currentGroup=groupName; document.getElementById("groupInfoPage").style.display="block";
  document.getElementById("chatPage").style.display="none"; const data = groupData[groupName];
  document.getElementById("infoGroupPhoto").src = data.photo;
  document.getElementById("infoGroupName").textContent = groupName; renderGroupMembers();
}
function backToChat(){ document.getElementById("groupInfoPage").style.display="none"; document.getElementById("chatPage").style.display="block"; }

/* ===== GROUP PHOTO ===== */
document.getElementById("infoGroupPhoto").onclick = ()=>{ document.getElementById("groupPhotoFile").click(); };
document.getElementById("groupPhotoFile").addEventListener("change", e=>{
  const file=e.target.files[0]; if(file){ const reader=new FileReader();
    reader.onload=()=>{ const url=reader.result;
      document.getElementById("infoGroupPhoto").src=url;
      document.getElementById("groupPhoto").src=url;
      groupData[currentGroup].photo=url;
    }; reader.readAsDataURL(file);
  }
});

/* ===== EDIT GROUP NAME ===== */
document.getElementById("infoGroupName").addEventListener("input", ()=>{
  const newName=document.getElementById("infoGroupName").textContent.trim();
  if(newName && newName!==currentGroup){ groupData[newName]={...groupData[currentGroup]}; delete groupData[currentGroup]; currentGroup=newName; document.getElementById("groupName").textContent=newName; }
});

/* ===== GROUP ACTIONS ===== */
function leaveGroup(){ if(confirm("Leave group?")){ alert("You left the group"); currentGroupMembers=[]; renderGroupMembers(); backToChat(); } }
function blockGroup(){ alert("Group blocked"); }
function reportGroup(){ alert("Group reported"); }
function deleteGroup(){ if(confirm("Delete group?")){ alert("Group deleted"); currentGroupMembers=[]; renderGroupMembers(); backToChat(); } }
function blockMember(){ const member=prompt("Enter member name to block:"); if(member && currentGroupMembers.includes(member)){ alert(member+" blocked"); } }

renderGroupMembers(); renderChatMembers();
</script>
</body>
</html>
